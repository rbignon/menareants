                   ********************
                   *  Europa Conquest *
                   ********************
                         [ API ]

Dernière modification:
$Id$

Sommaire:
1) Principe du jeu
2) Protocole
3) Particularités des commandes de positions
4) Modes
5) PLS
6) Etat d'une partie

1) Principe du jeu


2) Protocole
      a) Client -> Server
         - Général
              IAM <nick> <prog> <version>       :je me présente
              LSP                               :lister les parties
              CRE <nom>                         :créé une partie
              JOI <nom> [$]                     :joindre une partie ('$' signifie "créer le chan")
              STAT                              :request stats
              BYE                               :au revoir
         - Dans une pré-partie
              SET <mode(s)> [params]            :met un paramètre (voir section 4. Modes)
              KIK <nick> [raison]               :l'owner peut kicker
              GO!                               :l'owner lance le jeu
         - En cours de jeu
              ARM <nom> [+<nb>] [%<type>]       :modifier le status d'une armée
                  [/<nb>] [>] [^] [v] [<] [*<pos>]

      b) Serveur -> Client
         - Général
              HEL <prog> <version>              :welcome
              AIM <nick>                        :confirmation du IAM
              MOTD  <ligne>                     :motd
              EOM                               :fin du motd
              STAT <nbactco> <nbco> <nbch>      :stats sur le serveur
                   <chinwait> <chingame> <chtot> <uptime>
              LSP <nom> <+/-> <nbjoueurs>       :liste une partie
                  <nbmax> [map]
              EOL                               :fin de la liste
              MAJ <+|->                         :le client (ou le serveur) n'est pas à jour
              BYE [raison]                      :au revoir
              USED                              :pseudo déjà utilisé
         - Dans une pré-partie
              ER1                               :ne peut pas joindre
              PLS <params> [...]                :liste des joueurs (voir 5. PLS)
              LSM <nom> <nbmin> <nbmax>         :envoie la liste des cartes
              EOMAP                             :fin de la liste des maps
              :<nick> JOI <nom> <sets>          :un user join
              :<nick> SET <mode(s)> <value>     :un user met un paramètre (voir section 4. Modes)
              :<nick> LEA                       :un user part (ou a été kické)
              SMAP <map>                        :envoie la map
              EOSMAP                            :fin du SMAP
         - En cours de jeu
              :<nick>!<arm> ARM [+<nb>] [*<pos>]:montre le changement d'une armée
                          [%<type>] [<] [-] [.]
                          [=<arm>,<pos>,<movs>]
              :<nick>!<arm>[,<nick>!<arm> ...]  :ARM1 a battu ARM2 (et il reste tant...)
                      OWN <nick>!<arm> <f1>
                      [<f2> ...]

3) Particularités des commandes de positions
      Voici les arguments server -> client :
         +<nb>       :ajoute des unités (donne le nombre final)
         %<type>     :définit le type de l'armée
         =<O!E>,<x>, :change la position (on indique l'user dans le cas d'un * qui prendrait plusieurs senders)
          <y>,<[>][v][<][^]>
         *<pos>      :attaque
         <           :retour
         -           :suppression de l'armée
         .           :lock                    } application encore indéfinie
      Et client -> server :
         >           :déplacement de un à droite
         v           :déplacement de un vers le bas
         <           :déplacement de un à gauche
         ^           :déplacement de un vers le haut
         *<pos>      :attaque une position
         +           :création d'une entité
         =<pos>      : |- position de départ
         %<type>     : `- définit le type

4) Modes
      La commande SET nécessite l'utilisation de modes, semblables à l'IRC.
      Voici la liste :
        Mode pour le chan:
         +l <limite>         :paramètre la limite (serveur -> user uniquement)
         +o <user>           :met op un user
         +m <map>            :définie la map du jeu
         +W                  :pré-partie (WAITING)
         +S                  :envoie des infos (SENDING)
         +P                  :jeu (PLAYING)
         +A                  :animation (ANIMING)
        Mode pour un user:
         +c <couleur>        :l'user se définie sa couleur
         +p <position>       :l'user définie sa position
         +n <nation>         :l'user définie sa nation
         +!                  :le joueur est READY
         +$                  :l'argent du joueur (serveur -> user uniquement)

5) PLS
     La commande PLS a la particularité d'avoir une syntaxe plutot complexe et pas compréhensible
     sans document. C'est pourquoi je consacre ce cours paragraphe dans l'unique but de la détailler:

     PLS [@][!]<position>,<couleur>,<nation>,<pseudo> [...]
     [*]               :le joueur est owner
     [@]               :le joueur est op
     [!]               :le joueur est pret (Ready)
     <position>        :la position du joueur sur la carte
     <couleur>         :la couleur
     <nation>          :la nation
     <pseudo>          :le pseudo du joueur

6) Êtat d'une partie
     WAITING           :c'est la pré-partie
     SENDING           :le client créé la map physiquement et prépare toutes les données
     PLAYING           :les joueurs doivent jouer jusqu'à ce que tout le monde soit READY
     ANIMING           :animations commandées par le serveur